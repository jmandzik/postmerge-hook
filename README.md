Heavily inspired by https://github.com/nlf/precommit-hook
